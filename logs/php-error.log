[16-Jun-2025 12:57:55 America/Sao_Paulo] Iniciando busca de pneus disponíveis para empresa_id: 1
[16-Jun-2025 12:57:55 America/Sao_Paulo] Iniciando conexão com o banco de dados
[16-Jun-2025 12:57:55 America/Sao_Paulo] DB_SERVER: localhost:3307
[16-Jun-2025 12:57:55 America/Sao_Paulo] DB_NAME: sistema_frotas
[16-Jun-2025 12:57:55 America/Sao_Paulo] DB_USERNAME: root
[16-Jun-2025 12:57:55 America/Sao_Paulo] DSN: mysql:host=localhost:3307;dbname=sistema_frotas;charset=utf8
[16-Jun-2025 12:57:55 America/Sao_Paulo] Conexão com o banco de dados estabelecida com sucesso
[16-Jun-2025 12:57:55 America/Sao_Paulo] Conexão com o banco de dados estabelecida
[16-Jun-2025 12:57:55 America/Sao_Paulo] SQL: SELECT 
            p.id,
            p.numero_serie,
            p.marca,
            p.modelo,
            p.medida,
            p.sulco_inicial,
            p.dot,
            p.km_instalacao,
            p.data_instalacao,
            p.vida_util_km,
            p.numero_recapagens,
            p.data_ultima_recapagem,
            p.lote,
            p.data_entrada,
            p.observacoes,
            sp.nome as status_nome,
            CASE 
                WHEN p.status_id = 5 THEN 'bom'
                WHEN p.status_id = 4 THEN 'gasto'
                WHEN p.status_id = 1 THEN 'furado'
                WHEN p.status_id = 2 THEN 'reserva'
                WHEN p.status_id = 3 THEN 'descartado'
                ELSE 'gasto'
            END as status
            FROM pneus p
            LEFT JOIN status_pneus sp ON sp.id = p.status_id
            WHERE p.empresa_id = :empresa_id
            AND p.id NOT IN (
                SELECT pneu_id 
                FROM eixo_pneus 
                WHERE status = 'alocado'
            )
            AND p.status_id IN (2, 5) -- Apenas pneus em bom estado ou reserva
            ORDER BY p.numero_serie
[16-Jun-2025 12:57:55 America/Sao_Paulo] Pneus encontrados: 11
[16-Jun-2025 12:57:55 America/Sao_Paulo] Dados formatados e prontos para envio
[16-Jun-2025 12:57:58 America/Sao_Paulo] === INICIANDO ALOCAÇÃO DE PNEU ===
[16-Jun-2025 12:57:58 America/Sao_Paulo] Dados recebidos: Array
(
    [eixo_id] => 698
    [veiculo_id] => 59
    [lado] => direita
    [pneu_id] => 10
    [posicao_id] => 10
)

[16-Jun-2025 12:57:58 America/Sao_Paulo] Dados extraídos: eixo_id=698, veiculo_id=59, lado=direita, pneu_id=10, posicao_id=10
[16-Jun-2025 12:57:59 America/Sao_Paulo] Iniciando conexão com o banco de dados
[16-Jun-2025 12:57:59 America/Sao_Paulo] DB_SERVER: localhost:3307
[16-Jun-2025 12:57:59 America/Sao_Paulo] DB_NAME: sistema_frotas
[16-Jun-2025 12:57:59 America/Sao_Paulo] DB_USERNAME: root
[16-Jun-2025 12:57:59 America/Sao_Paulo] DSN: mysql:host=localhost:3307;dbname=sistema_frotas;charset=utf8
[16-Jun-2025 12:57:59 America/Sao_Paulo] Conexão com o banco de dados estabelecida com sucesso
[16-Jun-2025 12:57:59 America/Sao_Paulo] Conexão com o banco de dados estabelecida
[16-Jun-2025 12:57:59 America/Sao_Paulo] Resultado do SELECT: Array
(
    [0] => Array
        (
            [id] => 698
        )

)

[16-Jun-2025 12:57:59 America/Sao_Paulo] Iniciando transação
[16-Jun-2025 12:57:59 America/Sao_Paulo] Transação confirmada
[16-Jun-2025 18:34:21 America/Sao_Paulo] Iniciando busca de pneus disponíveis para empresa_id: 1
[16-Jun-2025 18:34:21 America/Sao_Paulo] Iniciando conexão com o banco de dados
[16-Jun-2025 18:34:21 America/Sao_Paulo] DB_SERVER: localhost:3307
[16-Jun-2025 18:34:21 America/Sao_Paulo] DB_NAME: sistema_frotas
[16-Jun-2025 18:34:21 America/Sao_Paulo] DB_USERNAME: root
[16-Jun-2025 18:34:21 America/Sao_Paulo] DSN: mysql:host=localhost:3307;dbname=sistema_frotas;charset=utf8
[16-Jun-2025 18:34:21 America/Sao_Paulo] Conexão com o banco de dados estabelecida com sucesso
[16-Jun-2025 18:34:21 America/Sao_Paulo] Conexão com o banco de dados estabelecida
[16-Jun-2025 18:34:21 America/Sao_Paulo] SQL: SELECT 
            p.id,
            p.numero_serie,
            p.marca,
            p.modelo,
            p.medida,
            p.sulco_inicial,
            p.dot,
            p.km_instalacao,
            p.data_instalacao,
            p.vida_util_km,
            p.numero_recapagens,
            p.data_ultima_recapagem,
            p.lote,
            p.data_entrada,
            p.observacoes,
            sp.nome as status_nome,
            CASE 
                WHEN p.status_id = 5 THEN 'bom'
                WHEN p.status_id = 4 THEN 'gasto'
                WHEN p.status_id = 1 THEN 'furado'
                WHEN p.status_id = 2 THEN 'reserva'
                WHEN p.status_id = 3 THEN 'descartado'
                ELSE 'gasto'
            END as status
            FROM pneus p
            LEFT JOIN status_pneus sp ON sp.id = p.status_id
            WHERE p.empresa_id = :empresa_id
            AND p.id NOT IN (
                SELECT pneu_id 
                FROM eixo_pneus 
                WHERE status = 'alocado'
            )
            AND p.status_id IN (2, 5) -- Apenas pneus em bom estado ou reserva
            ORDER BY p.numero_serie
[16-Jun-2025 18:34:21 America/Sao_Paulo] Pneus encontrados: 10
[16-Jun-2025 18:34:21 America/Sao_Paulo] Dados formatados e prontos para envio
[16-Jun-2025 18:34:24 America/Sao_Paulo] === INICIANDO ALOCAÇÃO DE PNEU ===
[16-Jun-2025 18:34:24 America/Sao_Paulo] Dados recebidos: Array
(
    [eixo_id] => 698
    [veiculo_id] => 59
    [lado] => undefined
    [pneu_id] => 13
    [posicao_id] => 10
)

[16-Jun-2025 18:34:24 America/Sao_Paulo] Dados extraídos: eixo_id=698, veiculo_id=59, lado=undefined, pneu_id=13, posicao_id=10
[16-Jun-2025 18:34:25 America/Sao_Paulo] Iniciando conexão com o banco de dados
[16-Jun-2025 18:34:25 America/Sao_Paulo] DB_SERVER: localhost:3307
[16-Jun-2025 18:34:25 America/Sao_Paulo] DB_NAME: sistema_frotas
[16-Jun-2025 18:34:25 America/Sao_Paulo] DB_USERNAME: root
[16-Jun-2025 18:34:25 America/Sao_Paulo] DSN: mysql:host=localhost:3307;dbname=sistema_frotas;charset=utf8
[16-Jun-2025 18:34:25 America/Sao_Paulo] Conexão com o banco de dados estabelecida com sucesso
[16-Jun-2025 18:34:25 America/Sao_Paulo] Conexão com o banco de dados estabelecida
[16-Jun-2025 18:34:25 America/Sao_Paulo] Resultado do SELECT: Array
(
    [0] => Array
        (
            [id] => 698
        )

)

[16-Jun-2025 18:34:25 America/Sao_Paulo] Erro ao alocar pneu: Posição já está ocupada por outro pneu
[16-Jun-2025 18:34:25 America/Sao_Paulo] Stack trace: #0 {main}
[17-Jun-2025 02:39:31 America/Sao_Paulo] Iniciando busca de pneus disponíveis para empresa_id: 1
[17-Jun-2025 02:39:31 America/Sao_Paulo] Iniciando conexão com o banco de dados
[17-Jun-2025 02:39:31 America/Sao_Paulo] DB_SERVER: localhost:3307
[17-Jun-2025 02:39:31 America/Sao_Paulo] DB_NAME: sistema_frotas
[17-Jun-2025 02:39:31 America/Sao_Paulo] DB_USERNAME: root
[17-Jun-2025 02:39:31 America/Sao_Paulo] DSN: mysql:host=localhost:3307;dbname=sistema_frotas;charset=utf8
[17-Jun-2025 02:39:31 America/Sao_Paulo] Conexão com o banco de dados estabelecida com sucesso
[17-Jun-2025 02:39:31 America/Sao_Paulo] Conexão com o banco de dados estabelecida
[17-Jun-2025 02:39:31 America/Sao_Paulo] SQL: SELECT 
            p.id,
            p.numero_serie,
            p.marca,
            p.modelo,
            p.medida,
            p.sulco_inicial,
            p.dot,
            p.km_instalacao,
            p.data_instalacao,
            p.vida_util_km,
            p.numero_recapagens,
            p.data_ultima_recapagem,
            p.lote,
            p.data_entrada,
            p.observacoes,
            sp.nome as status_nome,
            CASE 
                WHEN p.status_id = 5 THEN 'bom'
                WHEN p.status_id = 4 THEN 'gasto'
                WHEN p.status_id = 1 THEN 'furado'
                WHEN p.status_id = 2 THEN 'reserva'
                WHEN p.status_id = 3 THEN 'descartado'
                ELSE 'gasto'
            END as status
            FROM pneus p
            LEFT JOIN status_pneus sp ON sp.id = p.status_id
            WHERE p.empresa_id = :empresa_id
            AND p.id NOT IN (
                SELECT pneu_id 
                FROM eixo_pneus 
                WHERE status = 'alocado'
            )
            AND p.status_id IN (2, 5) -- Apenas pneus em bom estado ou reserva
            ORDER BY p.numero_serie
[17-Jun-2025 02:39:31 America/Sao_Paulo] Pneus encontrados: 10
[17-Jun-2025 02:39:31 America/Sao_Paulo] Dados formatados e prontos para envio
[17-Jun-2025 02:39:51 America/Sao_Paulo] Iniciando busca de pneus disponíveis para empresa_id: 1
[17-Jun-2025 02:39:51 America/Sao_Paulo] Iniciando conexão com o banco de dados
[17-Jun-2025 02:39:51 America/Sao_Paulo] DB_SERVER: localhost:3307
[17-Jun-2025 02:39:51 America/Sao_Paulo] DB_NAME: sistema_frotas
[17-Jun-2025 02:39:51 America/Sao_Paulo] DB_USERNAME: root
[17-Jun-2025 02:39:51 America/Sao_Paulo] DSN: mysql:host=localhost:3307;dbname=sistema_frotas;charset=utf8
[17-Jun-2025 02:39:51 America/Sao_Paulo] Conexão com o banco de dados estabelecida com sucesso
[17-Jun-2025 02:39:51 America/Sao_Paulo] Conexão com o banco de dados estabelecida
[17-Jun-2025 02:39:51 America/Sao_Paulo] SQL: SELECT 
            p.id,
            p.numero_serie,
            p.marca,
            p.modelo,
            p.medida,
            p.sulco_inicial,
            p.dot,
            p.km_instalacao,
            p.data_instalacao,
            p.vida_util_km,
            p.numero_recapagens,
            p.data_ultima_recapagem,
            p.lote,
            p.data_entrada,
            p.observacoes,
            sp.nome as status_nome,
            CASE 
                WHEN p.status_id = 5 THEN 'bom'
                WHEN p.status_id = 4 THEN 'gasto'
                WHEN p.status_id = 1 THEN 'furado'
                WHEN p.status_id = 2 THEN 'reserva'
                WHEN p.status_id = 3 THEN 'descartado'
                ELSE 'gasto'
            END as status
            FROM pneus p
            LEFT JOIN status_pneus sp ON sp.id = p.status_id
            WHERE p.empresa_id = :empresa_id
            AND p.id NOT IN (
                SELECT pneu_id 
                FROM eixo_pneus 
                WHERE status = 'alocado'
            )
            AND p.status_id IN (2, 5) -- Apenas pneus em bom estado ou reserva
            ORDER BY p.numero_serie
[17-Jun-2025 02:39:51 America/Sao_Paulo] Pneus encontrados: 10
[17-Jun-2025 02:39:51 America/Sao_Paulo] Dados formatados e prontos para envio
[17-Jun-2025 02:40:06 America/Sao_Paulo] Iniciando busca de pneus disponíveis para empresa_id: 1
[17-Jun-2025 02:40:06 America/Sao_Paulo] Iniciando conexão com o banco de dados
[17-Jun-2025 02:40:06 America/Sao_Paulo] DB_SERVER: localhost:3307
[17-Jun-2025 02:40:06 America/Sao_Paulo] DB_NAME: sistema_frotas
[17-Jun-2025 02:40:06 America/Sao_Paulo] DB_USERNAME: root
[17-Jun-2025 02:40:06 America/Sao_Paulo] DSN: mysql:host=localhost:3307;dbname=sistema_frotas;charset=utf8
[17-Jun-2025 02:40:06 America/Sao_Paulo] Conexão com o banco de dados estabelecida com sucesso
[17-Jun-2025 02:40:06 America/Sao_Paulo] Conexão com o banco de dados estabelecida
[17-Jun-2025 02:40:06 America/Sao_Paulo] SQL: SELECT 
            p.id,
            p.numero_serie,
            p.marca,
            p.modelo,
            p.medida,
            p.sulco_inicial,
            p.dot,
            p.km_instalacao,
            p.data_instalacao,
            p.vida_util_km,
            p.numero_recapagens,
            p.data_ultima_recapagem,
            p.lote,
            p.data_entrada,
            p.observacoes,
            sp.nome as status_nome,
            CASE 
                WHEN p.status_id = 5 THEN 'bom'
                WHEN p.status_id = 4 THEN 'gasto'
                WHEN p.status_id = 1 THEN 'furado'
                WHEN p.status_id = 2 THEN 'reserva'
                WHEN p.status_id = 3 THEN 'descartado'
                ELSE 'gasto'
            END as status
            FROM pneus p
            LEFT JOIN status_pneus sp ON sp.id = p.status_id
            WHERE p.empresa_id = :empresa_id
            AND p.id NOT IN (
                SELECT pneu_id 
                FROM eixo_pneus 
                WHERE status = 'alocado'
            )
            AND p.status_id IN (2, 5) -- Apenas pneus em bom estado ou reserva
            ORDER BY p.numero_serie
[17-Jun-2025 02:40:06 America/Sao_Paulo] Pneus encontrados: 10
[17-Jun-2025 02:40:06 America/Sao_Paulo] Dados formatados e prontos para envio
[18-Jun-2025 12:34:10 America/Sao_Paulo] Iniciando busca de pneus disponíveis para empresa_id: 1
[18-Jun-2025 12:34:10 America/Sao_Paulo] Iniciando conexão com o banco de dados
[18-Jun-2025 12:34:10 America/Sao_Paulo] DB_SERVER: localhost:3307
[18-Jun-2025 12:34:10 America/Sao_Paulo] DB_NAME: sistema_frotas
[18-Jun-2025 12:34:10 America/Sao_Paulo] DB_USERNAME: root
[18-Jun-2025 12:34:10 America/Sao_Paulo] DSN: mysql:host=localhost:3307;dbname=sistema_frotas;charset=utf8
[18-Jun-2025 12:34:10 America/Sao_Paulo] Conexão com o banco de dados estabelecida com sucesso
[18-Jun-2025 12:34:10 America/Sao_Paulo] Conexão com o banco de dados estabelecida
[18-Jun-2025 12:34:10 America/Sao_Paulo] SQL: SELECT 
            p.id,
            p.numero_serie,
            p.marca,
            p.modelo,
            p.medida,
            p.sulco_inicial,
            p.dot,
            p.km_instalacao,
            p.data_instalacao,
            p.vida_util_km,
            p.numero_recapagens,
            p.data_ultima_recapagem,
            p.lote,
            p.data_entrada,
            p.observacoes,
            sp.nome as status_nome,
            CASE 
                WHEN p.status_id = 5 THEN 'bom'
                WHEN p.status_id = 4 THEN 'gasto'
                WHEN p.status_id = 1 THEN 'furado'
                WHEN p.status_id = 2 THEN 'reserva'
                WHEN p.status_id = 3 THEN 'descartado'
                ELSE 'gasto'
            END as status
            FROM pneus p
            LEFT JOIN status_pneus sp ON sp.id = p.status_id
            WHERE p.empresa_id = :empresa_id
            AND p.id NOT IN (
                SELECT pneu_id 
                FROM instalacoes_pneus 
                WHERE data_remocao IS NULL
            )
            AND p.status_id IN (2, 5) -- Apenas pneus em bom estado ou reserva
            ORDER BY p.numero_serie
[18-Jun-2025 12:34:10 America/Sao_Paulo] Pneus encontrados: 12
[18-Jun-2025 12:34:10 America/Sao_Paulo] Dados formatados e prontos para envio
[18-Jun-2025 12:34:13 America/Sao_Paulo] Iniciando busca de pneus disponíveis para empresa_id: 1
[18-Jun-2025 12:34:13 America/Sao_Paulo] Iniciando conexão com o banco de dados
[18-Jun-2025 12:34:13 America/Sao_Paulo] DB_SERVER: localhost:3307
[18-Jun-2025 12:34:13 America/Sao_Paulo] DB_NAME: sistema_frotas
[18-Jun-2025 12:34:13 America/Sao_Paulo] DB_USERNAME: root
[18-Jun-2025 12:34:13 America/Sao_Paulo] DSN: mysql:host=localhost:3307;dbname=sistema_frotas;charset=utf8
[18-Jun-2025 12:34:13 America/Sao_Paulo] Conexão com o banco de dados estabelecida com sucesso
[18-Jun-2025 12:34:13 America/Sao_Paulo] Conexão com o banco de dados estabelecida
[18-Jun-2025 12:34:13 America/Sao_Paulo] SQL: SELECT 
            p.id,
            p.numero_serie,
            p.marca,
            p.modelo,
            p.medida,
            p.sulco_inicial,
            p.dot,
            p.km_instalacao,
            p.data_instalacao,
            p.vida_util_km,
            p.numero_recapagens,
            p.data_ultima_recapagem,
            p.lote,
            p.data_entrada,
            p.observacoes,
            sp.nome as status_nome,
            CASE 
                WHEN p.status_id = 5 THEN 'bom'
                WHEN p.status_id = 4 THEN 'gasto'
                WHEN p.status_id = 1 THEN 'furado'
                WHEN p.status_id = 2 THEN 'reserva'
                WHEN p.status_id = 3 THEN 'descartado'
                ELSE 'gasto'
            END as status
            FROM pneus p
            LEFT JOIN status_pneus sp ON sp.id = p.status_id
            WHERE p.empresa_id = :empresa_id
            AND p.id NOT IN (
                SELECT pneu_id 
                FROM instalacoes_pneus 
                WHERE data_remocao IS NULL
            )
            AND p.status_id IN (2, 5) -- Apenas pneus em bom estado ou reserva
            ORDER BY p.numero_serie
[18-Jun-2025 12:34:13 America/Sao_Paulo] Pneus encontrados: 12
[18-Jun-2025 12:34:13 America/Sao_Paulo] Dados formatados e prontos para envio
[18-Jun-2025 12:34:15 America/Sao_Paulo] Iniciando busca de pneus disponíveis para empresa_id: 1
[18-Jun-2025 12:34:15 America/Sao_Paulo] Iniciando conexão com o banco de dados
[18-Jun-2025 12:34:15 America/Sao_Paulo] DB_SERVER: localhost:3307
[18-Jun-2025 12:34:15 America/Sao_Paulo] DB_NAME: sistema_frotas
[18-Jun-2025 12:34:15 America/Sao_Paulo] DB_USERNAME: root
[18-Jun-2025 12:34:15 America/Sao_Paulo] DSN: mysql:host=localhost:3307;dbname=sistema_frotas;charset=utf8
[18-Jun-2025 12:34:15 America/Sao_Paulo] Conexão com o banco de dados estabelecida com sucesso
[18-Jun-2025 12:34:15 America/Sao_Paulo] Conexão com o banco de dados estabelecida
[18-Jun-2025 12:34:15 America/Sao_Paulo] SQL: SELECT 
            p.id,
            p.numero_serie,
            p.marca,
            p.modelo,
            p.medida,
            p.sulco_inicial,
            p.dot,
            p.km_instalacao,
            p.data_instalacao,
            p.vida_util_km,
            p.numero_recapagens,
            p.data_ultima_recapagem,
            p.lote,
            p.data_entrada,
            p.observacoes,
            sp.nome as status_nome,
            CASE 
                WHEN p.status_id = 5 THEN 'bom'
                WHEN p.status_id = 4 THEN 'gasto'
                WHEN p.status_id = 1 THEN 'furado'
                WHEN p.status_id = 2 THEN 'reserva'
                WHEN p.status_id = 3 THEN 'descartado'
                ELSE 'gasto'
            END as status
            FROM pneus p
            LEFT JOIN status_pneus sp ON sp.id = p.status_id
            WHERE p.empresa_id = :empresa_id
            AND p.id NOT IN (
                SELECT pneu_id 
                FROM instalacoes_pneus 
                WHERE data_remocao IS NULL
            )
            AND p.status_id IN (2, 5) -- Apenas pneus em bom estado ou reserva
            ORDER BY p.numero_serie
[18-Jun-2025 12:34:15 America/Sao_Paulo] Pneus encontrados: 12
[18-Jun-2025 12:34:15 America/Sao_Paulo] Dados formatados e prontos para envio
[18-Jun-2025 12:34:17 America/Sao_Paulo] Iniciando busca de pneus disponíveis para empresa_id: 1
[18-Jun-2025 12:34:17 America/Sao_Paulo] Iniciando conexão com o banco de dados
[18-Jun-2025 12:34:17 America/Sao_Paulo] DB_SERVER: localhost:3307
[18-Jun-2025 12:34:17 America/Sao_Paulo] DB_NAME: sistema_frotas
[18-Jun-2025 12:34:17 America/Sao_Paulo] DB_USERNAME: root
[18-Jun-2025 12:34:17 America/Sao_Paulo] DSN: mysql:host=localhost:3307;dbname=sistema_frotas;charset=utf8
[18-Jun-2025 12:34:17 America/Sao_Paulo] Conexão com o banco de dados estabelecida com sucesso
[18-Jun-2025 12:34:17 America/Sao_Paulo] Conexão com o banco de dados estabelecida
[18-Jun-2025 12:34:17 America/Sao_Paulo] SQL: SELECT 
            p.id,
            p.numero_serie,
            p.marca,
            p.modelo,
            p.medida,
            p.sulco_inicial,
            p.dot,
            p.km_instalacao,
            p.data_instalacao,
            p.vida_util_km,
            p.numero_recapagens,
            p.data_ultima_recapagem,
            p.lote,
            p.data_entrada,
            p.observacoes,
            sp.nome as status_nome,
            CASE 
                WHEN p.status_id = 5 THEN 'bom'
                WHEN p.status_id = 4 THEN 'gasto'
                WHEN p.status_id = 1 THEN 'furado'
                WHEN p.status_id = 2 THEN 'reserva'
                WHEN p.status_id = 3 THEN 'descartado'
                ELSE 'gasto'
            END as status
            FROM pneus p
            LEFT JOIN status_pneus sp ON sp.id = p.status_id
            WHERE p.empresa_id = :empresa_id
            AND p.id NOT IN (
                SELECT pneu_id 
                FROM instalacoes_pneus 
                WHERE data_remocao IS NULL
            )
            AND p.status_id IN (2, 5) -- Apenas pneus em bom estado ou reserva
            ORDER BY p.numero_serie
[18-Jun-2025 12:34:17 America/Sao_Paulo] Pneus encontrados: 12
[18-Jun-2025 12:34:17 America/Sao_Paulo] Dados formatados e prontos para envio
